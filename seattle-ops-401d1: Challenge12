

from ipaddress import IPv4Network
import random
from scapy.all import ICMP, IP, sr1, TCP

# IP range to ping
network = "192.168.117.0/24"

# List of addresses 
addresses = IPv4Network(network)
live_count = 0

# ICMP ping request, wait for response host address
    if (host in (addresses.network_address, addresses.broadcast_address)):
        # Igore network and broadcast address

    resp = sr1(
        IP(dst=str(host))/ICMP(),
        timeout=2,
        verbose=0,
    )

    if resp is None:
        print(f"{host} is down or not responding.")
    elif (
        int(resp.getlayer(ICMP).type)==3 and
        int(resp.getlayer(ICMP).code) in [1,2,3,9,10,13]
    ):
        print(f"{host} is blocking ICMP.")
    else:
        print(f"{host} is responding.")
        live_count += 1

print(f"{live_count}/{addresses.num_addresses} hosts are online.")
